<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Project Management Server - Architecture Report</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      line-height: 1.6;
      color: #333;
      max-width: 900px;
      margin: 0 auto;
      padding: 40px 20px;
      background: #f5f5f5;
    }
    .container {
      background: white;
      padding: 40px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    h1 {
      color: #2c3e50;
      border-bottom: 3px solid #3498db;
      padding-bottom: 15px;
      margin-bottom: 30px;
      font-size: 2rem;
    }
    h2 {
      color: #2980b9;
      margin: 30px 0 15px;
      padding-bottom: 8px;
      border-bottom: 2px solid #ecf0f1;
    }
    h3 {
      color: #34495e;
      margin: 20px 0 10px;
    }
    pre {
      background: #2c3e50;
      color: #ecf0f1;
      padding: 20px;
      border-radius: 8px;
      overflow-x: auto;
      font-size: 12px;
      line-height: 1.4;
      margin: 15px 0;
    }
    code {
      background: #ecf0f1;
      padding: 2px 6px;
      border-radius: 4px;
      font-family: 'Consolas', monospace;
      font-size: 0.9em;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 15px 0;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 12px;
      text-align: left;
    }
    th {
      background: #3498db;
      color: white;
    }
    tr:nth-child(even) { background: #f9f9f9; }
    tr:hover { background: #f1f1f1; }
    .flow-box {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 15px 20px;
      border-radius: 8px;
      margin: 10px 0;
      font-size: 14px;
    }
    .flow-arrow {
      text-align: center;
      font-size: 24px;
      color: #3498db;
      margin: 5px 0;
    }
    .highlight {
      background: #fff3cd;
      padding: 15px;
      border-left: 4px solid #ffc107;
      margin: 15px 0;
    }
    .emoji { font-size: 1.2em; }
    ul { margin-left: 20px; margin-bottom: 15px; }
    li { margin: 8px 0; }
    .section { page-break-inside: avoid; }
    @media print {
      body { background: white; }
      .container { box-shadow: none; padding: 20px; }
      pre { font-size: 10px; }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üèóÔ∏è Project Management Server - Architecture Report</h1>
    <p><strong>Generated:</strong> December 28, 2025</p>

    <div class="section">
      <h2>üìÇ Folder Structure Overview</h2>
      <pre>
server/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ index.js          ‚Üê Entry Point (starts everything)
‚îÇ   ‚îú‚îÄ‚îÄ app.js            ‚Üê Express App Configuration
‚îÇ   ‚îú‚îÄ‚îÄ db/index.js       ‚Üê Database Connection
‚îÇ   ‚îú‚îÄ‚îÄ models/           ‚Üê Data Schemas (how data looks)
‚îÇ   ‚îú‚îÄ‚îÄ routes/           ‚Üê URL Endpoints (where to go)
‚îÇ   ‚îú‚îÄ‚îÄ controllers/      ‚Üê Business Logic (what to do)
‚îÇ   ‚îú‚îÄ‚îÄ middlewares/      ‚Üê Request Processing (checks before action)
‚îÇ   ‚îú‚îÄ‚îÄ utils/            ‚Üê Helper Functions (reusable tools)
‚îÇ   ‚îî‚îÄ‚îÄ validators/       ‚Üê Input Validation (data checking)
‚îî‚îÄ‚îÄ public/               ‚Üê Static Files (images, etc.)
      </pre>
    </div>

    <div class="section">
      <h2>üîÑ Request Flow Diagram</h2>
      
      <div class="flow-box">
        <strong>1. CLIENT (Postman/Browser/App)</strong><br>
        Sends: POST /api/v1/auth/register
      </div>
      <div class="flow-arrow">‚ñº</div>
      
      <div class="flow-box" style="background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);">
        <strong>2. index.js - SERVER STARTUP</strong><br>
        ‚Ä¢ Loads environment variables (.env)<br>
        ‚Ä¢ Connects to MongoDB<br>
        ‚Ä¢ Starts Express server on PORT 8000
      </div>
      <div class="flow-arrow">‚ñº</div>
      
      <div class="flow-box" style="background: linear-gradient(135deg, #fc4a1a 0%, #f7b733 100%);">
        <strong>3. app.js - MIDDLEWARE PIPELINE</strong><br>
        ‚Ä¢ CORS (allows cross-origin requests)<br>
        ‚Ä¢ express.json() (parses JSON body ‚Üí req.body)<br>
        ‚Ä¢ express.urlencoded() (parses URL parameters)<br>
        ‚Ä¢ Routes requests to appropriate router
      </div>
      <div class="flow-arrow">‚ñº</div>
      
      <div class="flow-box" style="background: linear-gradient(135deg, #5c258d 0%, #4389a2 100%);">
        <strong>4. routes/auth.routes.js - ROUTE MATCHING</strong><br>
        ‚Ä¢ Matches URL pattern: /api/v1/auth/register<br>
        ‚Ä¢ Calls: registerUser controller
      </div>
      <div class="flow-arrow">‚ñº</div>
      
      <div class="flow-box" style="background: linear-gradient(135deg, #134e5e 0%, #71b280 100%);">
        <strong>5. utils/asyncHandler.js - ERROR WRAPPER</strong><br>
        ‚Ä¢ Wraps async function in try-catch<br>
        ‚Ä¢ Catches any errors and passes to error handler
      </div>
      <div class="flow-arrow">‚ñº</div>
      
      <div class="flow-box" style="background: linear-gradient(135deg, #ee0979 0%, #ff6a00 100%);">
        <strong>6. controllers/auth.controllers.js - BUSINESS LOGIC</strong><br>
        ‚Ä¢ Extracts data from req.body<br>
        ‚Ä¢ Validates required fields<br>
        ‚Ä¢ Checks for existing user<br>
        ‚Ä¢ Creates new user in database<br>
        ‚Ä¢ Generates verification token<br>
        ‚Ä¢ Sends verification email<br>
        ‚Ä¢ Returns success response
      </div>
      <div class="flow-arrow">‚ñº</div>
      
      <div class="flow-box" style="background: linear-gradient(135deg, #373b44 0%, #4286f4 100%);">
        <strong>7. models/user.models.js - DATABASE OPERATIONS</strong><br>
        ‚Ä¢ Defines User schema (what fields a user has)<br>
        ‚Ä¢ Pre-save hook: Hashes password before saving<br>
        ‚Ä¢ Methods: generateAccessToken, generateRefreshToken<br>
        ‚Ä¢ Methods: isPasswordCorrect, generateTemporaryForgotPasswordToken
      </div>
      <div class="flow-arrow">‚ñº</div>
      
      <div class="flow-box" style="background: linear-gradient(135deg, #6a3093 0%, #a044ff 100%);">
        <strong>8. utils/mail.js - EMAIL SERVICE</strong><br>
        ‚Ä¢ Creates email content using Mailgen<br>
        ‚Ä¢ Sends email via Nodemailer + Mailtrap
      </div>
      <div class="flow-arrow">‚ñº</div>
      
      <div class="flow-box" style="background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);">
        <strong>9. CLIENT RECEIVES RESPONSE</strong><br>
        { statusCode, data, message, success }
      </div>
    </div>

    <div class="section">
      <h2>üè† Real-Life Example: Hotel Check-In System</h2>
      <p>Imagine your server as a <strong>luxury hotel</strong>:</p>
      
      <table>
        <tr>
          <th>Component</th>
          <th>Hotel Equivalent</th>
          <th>What it Does</th>
        </tr>
        <tr>
          <td><strong>index.js</strong></td>
          <td>Hotel Opening in Morning</td>
          <td>Opens the doors, turns on lights, connects all systems</td>
        </tr>
        <tr>
          <td><strong>app.js</strong></td>
          <td>Reception Lobby</td>
          <td>First point of contact, directs guests to right department</td>
        </tr>
        <tr>
          <td><strong>routes/</strong></td>
          <td>Directory Signs</td>
          <td>"Room Booking ‚Üí 1st Floor", "Restaurant ‚Üí 2nd Floor"</td>
        </tr>
        <tr>
          <td><strong>middlewares/</strong></td>
          <td>Security Guards</td>
          <td>Check IDs, verify reservations before allowing entry</td>
        </tr>
        <tr>
          <td><strong>controllers/</strong></td>
          <td>Department Staff</td>
          <td>Actually perform the work (book room, serve food)</td>
        </tr>
        <tr>
          <td><strong>models/</strong></td>
          <td>Hotel Database</td>
          <td>Guest records, room information, booking history</td>
        </tr>
        <tr>
          <td><strong>utils/</strong></td>
          <td>Hotel Utilities</td>
          <td>Key generators, phone system, email system</td>
        </tr>
        <tr>
          <td><strong>validators/</strong></td>
          <td>Form Checkers</td>
          <td>Ensure booking forms are filled correctly</td>
        </tr>
      </table>

      <h3>üõéÔ∏è Guest Registration Flow (Like User Registration)</h3>
      <pre>
1. Guest arrives at hotel (Request hits server)
         ‚Üì
2. Security checks if guest is allowed (CORS middleware)
         ‚Üì
3. Reception asks "How can I help?" (Route matching)
         ‚Üì
4. Guest says "I want to book a room" (POST /api/v1/auth/register)
         ‚Üì
5. Receptionist asks for details:
   - Name (username)
   - Email (email)
   - ID Password (password)
         ‚Üì
6. Receptionist checks computer:
   - "Is this guest already registered?" (Check existing user)
   - "Is name/email unique?" (Validation)
         ‚Üì
7. If new guest:
   - Creates guest profile (User.create)
   - Password stored in safe (bcrypt hashing)
   - Generates room key (Access Token)
   - Generates master key (Refresh Token)
   - Sends welcome email with verification (Nodemailer)
         ‚Üì
8. Returns welcome packet to guest (API Response)
      </pre>
    </div>

    <div class="section">
      <h2>üîê Security Mechanisms</h2>
      <table>
        <tr>
          <th>Security Layer</th>
          <th>File</th>
          <th>Purpose</th>
        </tr>
        <tr>
          <td><strong>Password Hashing</strong></td>
          <td>user.models.js</td>
          <td>Converts passwords to unreadable format using bcrypt</td>
        </tr>
        <tr>
          <td><strong>JWT Access Token</strong></td>
          <td>user.models.js</td>
          <td>Short-lived token (like a day pass)</td>
        </tr>
        <tr>
          <td><strong>JWT Refresh Token</strong></td>
          <td>user.models.js</td>
          <td>Long-lived token (like a membership card)</td>
        </tr>
        <tr>
          <td><strong>Email Verification Token</strong></td>
          <td>user.models.js</td>
          <td>Temporary token to verify email ownership</td>
        </tr>
        <tr>
          <td><strong>CORS</strong></td>
          <td>app.js</td>
          <td>Controls which websites can access your API</td>
        </tr>
      </table>
    </div>

    <div class="section">
      <h2>üìä User Model Fields</h2>
      <table>
        <tr>
          <th>Field</th>
          <th>Type</th>
          <th>Purpose</th>
        </tr>
        <tr><td>username</td><td>String</td><td>Unique identifier for login</td></tr>
        <tr><td>email</td><td>String</td><td>Contact & verification</td></tr>
        <tr><td>password</td><td>String</td><td>Authentication (hashed)</td></tr>
        <tr><td>avatar</td><td>Object</td><td>Profile picture URL</td></tr>
        <tr><td>isEmailVerified</td><td>Boolean</td><td>Email confirmation status</td></tr>
        <tr><td>refreshToken</td><td>String</td><td>For token refresh</td></tr>
        <tr><td>forgotPasswordToken</td><td>String</td><td>Password reset</td></tr>
        <tr><td>emailVerificationToken</td><td>String</td><td>Email verification</td></tr>
      </table>
    </div>

    <div class="section">
      <h2>üõ†Ô∏è Utility Classes</h2>
      
      <h3>ApiError (Custom Error Handling)</h3>
      <pre>
throw new ApiError(400, 'Email is required')
// Returns: { statusCode: 400, message: 'Email is required', success: false }
      </pre>

      <h3>ApiResponse (Standardized Success)</h3>
      <pre>
new ApiResponse(200, userData, 'User created successfully')
// Returns: { statusCode: 200, data: userData, message: '...', success: true }
      </pre>

      <h3>asyncHandler (Error Wrapper)</h3>
      <pre>
// Wraps async functions to automatically catch errors
// No need to write try-catch in every controller
      </pre>
    </div>

    <div class="section">
      <h2>üéØ Current API Endpoints</h2>
      <table>
        <tr>
          <th>Method</th>
          <th>Endpoint</th>
          <th>Controller</th>
          <th>Purpose</th>
        </tr>
        <tr>
          <td>GET</td>
          <td>/</td>
          <td>Inline</td>
          <td>Welcome message</td>
        </tr>
        <tr>
          <td>GET</td>
          <td>/api/v1/healthcheck</td>
          <td>healthcheck</td>
          <td>Server status check</td>
        </tr>
        <tr>
          <td>POST</td>
          <td>/api/v1/auth/register</td>
          <td>registerUser</td>
          <td>User registration</td>
        </tr>
      </table>
    </div>

    <div class="section">
      <h2>üìß Email Flow</h2>
      <pre>
User registers ‚Üí Server generates token ‚Üí Mailgen creates HTML email
                                                    ‚Üì
                                        Nodemailer sends via Mailtrap
                                                    ‚Üì
                                        User receives verification email
                                                    ‚Üì
                                        User clicks link ‚Üí Email verified
      </pre>
    </div>

    <div class="highlight">
      <strong>üìù Note:</strong> This architecture follows the <strong>MVC pattern</strong> (Model-View-Controller) 
      and is scalable for adding more features like login, password reset, project management, task management, etc.
    </div>

    <hr style="margin: 30px 0;">
    <p style="text-align: center; color: #7f8c8d;">
      <em>Generated by GitHub Copilot ‚Ä¢ Project Management Server Documentation</em>
    </p>
  </div>
</body>
</html>
